<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>For You ‚ù§Ô∏è</title>
  <style>
    :root{
      --bg1:#ffdde1;
      --bg2:#ee9ca7;
      --card:#ffffffcc;
      --text:#2b2b2b;
      --accent:#ff4d6d;
      --accent2:#d6336c;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
      background: radial-gradient(circle at top left, var(--bg1), var(--bg2));
      overflow:hidden;
    }

    /* Floating hearts layer */
    #hearts{
      position:fixed;
      inset:0;
      pointer-events:none;
      overflow:hidden;
      z-index:1;
    }
    .heart{
      position:absolute;
      width:14px;
      height:14px;
      transform: rotate(45deg);
      opacity:0.9;
      animation: floatUp linear forwards;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.15));
    }
    .heart::before,
    .heart::after{
      content:"";
      position:absolute;
      width:14px;
      height:14px;
      border-radius:50%;
      background:inherit;
    }
    .heart::before{ left:-7px; top:0; }
    .heart::after{ left:0; top:-7px; }

    @keyframes floatUp{
      0%{ transform:translateY(0) rotate(45deg); opacity:0; }
      10%{ opacity:0.95; }
      100%{ transform:translateY(-110vh) rotate(45deg); opacity:0; }
    }

    /* Confetti canvas */
    #confettiCanvas{
      position:fixed;
      inset:0;
      z-index:999;
      pointer-events:none;
    }

    /* Main card */
    .card{
      position:relative;
      z-index:2;
      width:min(560px, 92vw);
      background:var(--card);
      backdrop-filter: blur(8px);
      border: 1px solid rgba(255,255,255,0.35);
      border-radius:24px;
      box-shadow: 0 18px 60px rgba(0,0,0,0.18);
      padding:26px 22px 22px;
      text-align:center;
    }

    h1{
      margin:6px 0 10px;
      color:var(--accent2);
      font-size: clamp(28px, 5vw, 36px);
      line-height:1.1;
    }
    p{
      margin: 10px 0 0;
      font-size: 16px;
      line-height:1.6;
      white-space: pre-wrap;
    }

    .btnrow{
      margin-top:18px;
      display:flex;
      gap:12px;
      justify-content:center;
      flex-wrap:wrap;
    }
    button{
      border:none;
      border-radius:14px;
      padding:14px 20px;
      font-size:16px;
      cursor:pointer;
      transition: transform 0.08s ease, box-shadow 0.15s ease;
      box-shadow: 0 10px 24px rgba(0,0,0,0.12);
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }
    button:active{ transform: translateY(1px) scale(0.99); }

    .yes{
      background: var(--accent);
      color:#fff;
    }
    .no{
      background: #6c757d;
      color:#fff;
      position:relative;
    }

    .small{
      margin-top:14px;
      font-size:13px;
      opacity:0.85;
    }

    /* Photo */
    .photo-wrap{
      margin:16px auto 0;
      width:220px;
      height:220px;
      border-radius:22px;
      overflow:hidden;
      border: 2px solid rgba(255,255,255,0.55);
      box-shadow: 0 10px 30px rgba(0,0,0,0.15);
      background: rgba(255,255,255,0.4);
      animation: popIn 420ms ease;
    }
    .photo-wrap img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }
    @keyframes popIn{
      from{ transform: scale(0.88); opacity: 0; }
      to{ transform: scale(1); opacity: 1; }
    }

    /* Tap-to-start overlay for audio */
    #startOverlay{
      position:fixed;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      background: rgba(0,0,0,0.28);
      z-index:1000;
      padding:18px;
    }
    .overlayCard{
      width:min(520px, 92vw);
      background: rgba(255,255,255,0.9);
      border-radius:22px;
      padding:20px 18px;
      text-align:center;
      box-shadow: 0 18px 60px rgba(0,0,0,0.25);
    }
    .overlayCard h2{
      margin:0 0 8px;
      color: var(--accent2);
    }
    .overlayCard p{
      margin:0 0 14px;
    }
    .overlayBtn{
      background: var(--accent);
      color:#fff;
      width:100%;
    }

    /* Screen switching */
    #screen2{ display:none; }
  </style>
</head>
<body>

  <!-- Confetti -->
  <canvas id="confettiCanvas"></canvas>

  <!-- Floating hearts container -->
  <div id="hearts"></div>

  <!-- Tap overlay (for starting audio) -->
  <div id="startOverlay">
    <div class="overlayCard">
      <h2>One tap before we begin üíó</h2>
      <p>Tap to start the page (and the song).</p>
      <button class="overlayBtn" id="startBtn">Start üíû</button>
      <div class="small">Tip: your photo must be named <b>us.jpg</b> in the repo.</div>
    </div>
  </div>

  <div class="card">
    <!-- SCREEN 1 -->
    <div id="screen1">
      <h1>Will you be my Valentine? ‚ù§Ô∏è</h1>
      <div class="btnrow">
        <button class="yes" id="yesBtn">Yes üíï</button>
        <button class="no" id="noBtn">No üò¢</button>
      </div>
      <div class="small">Made with love ‚ú®</div>
    </div>

    <!-- SCREEN 2 -->
    <div id="screen2">
      <h1>Happy Valentine‚Äôs ‚ù§Ô∏è</h1>
      <p id="messageLine"></p>
      <div class="photo-wrap">
        <img id="herPhoto" src="" alt="Our photo">
      </div>
      <div class="small">I love you üíò</div>
    </div>
  </div>

  <!-- Background music -->
  <audio id="bgMusic" loop>
    <source src="Cold_Play_-_Yellow_3_(mp3.pm).mp3" type="audio/mpeg">
  </audio>

  <script>
    /***********************
     * CUSTOMIZE HERE
     ***********************/
    const CONFIG = {
      messageLine:
        "I love you forever. This may not be the valentines we wanted, but I will always try to make every valentine we have together special because you are so special. You are my forever, my best friend, my girlfriend. The most beautiful girl I've ever seen. You should know that you're amazing and you mean the world to me.",
      herPhotoUrl: "us.jpg", // make sure this file exists in the repo root
      heartSpawnMs: 220
    };

    /***********************
     * Start overlay + audio
     ***********************/
    const overlay = document.getElementById("startOverlay");
    const startBtn = document.getElementById("startBtn");
    const music = document.getElementById("bgMusic");

    async function startExperience(){
      overlay.style.display = "none";
      overlay.style.pointerEvents = "none";
      try{
        music.volume = 0.5;
        await music.play();
      }catch(e){
        console.log("Music blocked or missing:", e);
      }
    }
    startBtn.addEventListener("click", startExperience);

    /***********************
     * Floating hearts
     ***********************/
    const heartsLayer = document.getElementById("hearts");
    function rand(min, max){ return Math.random() * (max - min) + min; }

    function spawnHeart(){
      const heart = document.createElement("div");
      heart.className = "heart";

      const size = rand(10, 18);
      heart.style.width = size + "px";
      heart.style.height = size + "px";

      const left = rand(0, 100);
      heart.style.left = left + "vw";
      heart.style.bottom = "-20px";

      const duration = rand(4.5, 8.5);
      heart.style.animationDuration = duration + "s";

      const colors = ["#ff4d6d", "#ff758f", "#ff8fab", "#d6336c", "#ff3b6b"];
      heart.style.background = colors[Math.floor(Math.random() * colors.length)];

      heartsLayer.appendChild(heart);
      setTimeout(() => heart.remove(), duration * 1000 + 200);
    }

    let heartInterval = setInterval(spawnHeart, CONFIG.heartSpawnMs);

    /***********************
     * Confetti (simple canvas)
     ***********************/
    const canvas = document.getElementById("confettiCanvas");
    const ctx = canvas.getContext("2d");

    function resizeCanvas(){
      canvas.width = window.innerWidth * devicePixelRatio;
      canvas.height = window.innerHeight * devicePixelRatio;
      canvas.style.width = window.innerWidth + "px";
      canvas.style.height = window.innerHeight + "px";
      ctx.setTransform(devicePixelRatio, 0, 0, devicePixelRatio, 0, 0);
    }
    window.addEventListener("resize", resizeCanvas);
    resizeCanvas();

    let confettiPieces = [];
    let confettiRunning = false;

    function makeConfettiBurst(count=180){
      const w = window.innerWidth;
      const h = window.innerHeight;
      const originX = w/2;
      const originY = h/3;

      const colors = ["#ff4d6d", "#ff758f", "#ff8fab", "#ffd6e0", "#ffffff", "#d6336c"];

      for(let i=0;i<count;i++){
        confettiPieces.push({
          x: originX, y: originY,
          vx: rand(-6, 6),
          vy: rand(-10, -3),
          g: rand(0.12, 0.22),
          size: rand(4, 7),
          rot: rand(0, Math.PI),
          vr: rand(-0.2, 0.2),
          color: colors[Math.floor(Math.random()*colors.length)],
          life: rand(70, 120)
        });
      }
    }

    function drawConfetti(){
      if(!confettiRunning) return;

      ctx.clearRect(0,0,window.innerWidth, window.innerHeight);
      confettiPieces = confettiPieces.filter(p => p.life > 0);

      for(const p of confettiPieces){
        p.life -= 1;
        p.vy += p.g;
        p.x += p.vx;
        p.y += p.vy;
        p.rot += p.vr;

        ctx.save();
        ctx.translate(p.x, p.y);
        ctx.rotate(p.rot);
        ctx.fillStyle = p.color;
        ctx.fillRect(-p.size/2, -p.size/2, p.size, p.size*1.4);
        ctx.restore();
      }

      if(confettiPieces.length === 0){
        confettiRunning = false;
        ctx.clearRect(0,0,window.innerWidth, window.innerHeight);
        return;
      }
      requestAnimationFrame(drawConfetti);
    }

    function startConfetti(){
      confettiRunning = true;
      makeConfettiBurst();
      requestAnimationFrame(drawConfetti);
      setTimeout(() => { confettiPieces = []; }, 4000);
    }

    /***********************
     * Buttons behavior
     ***********************/
    const yesBtn = document.getElementById("yesBtn");
    const noBtn = document.getElementById("noBtn");
    const card = document.querySelector(".card");

    // YES -> switch screens and show message + photo
    function goYes(){
      document.getElementById("screen1").style.display = "none";
      document.getElementById("screen2").style.display = "block";

      document.getElementById("messageLine").textContent = CONFIG.messageLine;
      document.getElementById("herPhoto").src = CONFIG.herPhotoUrl;

      startConfetti();

      // Bonus: faster hearts for a moment
      clearInterval(heartInterval);
      heartInterval = setInterval(spawnHeart, 120);
      setTimeout(() => {
        clearInterval(heartInterval);
        heartInterval = setInterval(spawnHeart, CONFIG.heartSpawnMs);
      }, 3500);
    }

    yesBtn.addEventListener("click", goYes);
    // mobile responsiveness
    yesBtn.addEventListener("pointerdown", () => yesBtn.click());

    // EVIL NO button (runs away but NEVER blocks YES)
    function teleportNoAvoidYes(){
      const cardRect = card.getBoundingClientRect();
      const yesRect = yesBtn.getBoundingClientRect();

      const pad = 16;
      const maxX = cardRect.width - noBtn.offsetWidth - pad;
      const maxY = cardRect.height - noBtn.offsetHeight - pad;

      // YES position relative to card
      const yesLeft = yesRect.left - cardRect.left;
      const yesTop = yesRect.top - cardRect.top;
      const yesRight = yesLeft + yesRect.width;
      const yesBottom = yesTop + yesRect.height;

      for(let tries=0; tries<25; tries++){
        const x = pad + Math.random() * Math.max(1, maxX - pad);
        const y = pad + Math.random() * Math.max(1, maxY - pad);

        const noLeft = x;
        const noTop = y;
        const noRight = x + noBtn.offsetWidth;
        const noBottom = y + noBtn.offsetHeight;

        const overlapsYes = !(noRight < yesLeft || noLeft > yesRight || noBottom < yesTop || noTop > yesBottom);

        if(!overlapsYes){
          noBtn.style.position = "absolute";
          noBtn.style.left = x + "px";
          noBtn.style.top = y + "px";
          return;
        }
      }

      // fallback: top-right
      noBtn.style.position = "absolute";
      noBtn.style.left = Math.max(pad, maxX) + "px";
      noBtn.style.top = pad + "px";
    }

    // Run away when pointer gets close
    card.addEventListener("pointermove", (e) => {
      const b = noBtn.getBoundingClientRect();
      const dx = (b.left + b.width/2) - e.clientX;
      const dy = (b.top + b.height/2) - e.clientY;
      if(Math.hypot(dx, dy) < 140) teleportNoAvoidYes();
    });

    // prevent clicks/taps on NO
    noBtn.addEventListener("pointerdown", (e) => {
      e.preventDefault();
      e.stopPropagation();
      teleportNoAvoidYes();
    });

    // place it safely at start
    teleportNoAvoidYes();
  </script>
</body>
</html>

